<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>IoT Agr√≠cola ‚Äì Arroz</title>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #2e7d32;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .card {
      background: white;
      padding: 15px;
      border-radius: 10px;
    }

    .ia {
      margin-top: 30px;
      background: #e8f5e9;
      padding: 20px;
      border-radius: 10px;
      font-size: 18px;
    }
  </style>
</head>

<body>

<h1>üåæ Sistema IoT para Replante de Arroz</h1>

<div class="grid">
  <div class="card"><canvas id="humedad"></canvas></div>
  <div class="card"><canvas id="tempSuelo"></canvas></div>
  <div class="card"><canvas id="tempAmb"></canvas></div>
  <div class="card"><canvas id="luz"></canvas></div>
  <div class="card"><canvas id="ph"></canvas></div>
</div>

<div class="ia">
  <strong>ü§ñ Asistencia Inteligente:</strong>
  <p id="recomendacion">Analizando datos...</p>
</div>

<script>
const maxPuntos = 10;

function crearGrafico(id, label, min, max) {
  return new Chart(document.getElementById(id), {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label,
        data: [],
        borderWidth: 2,
        fill: false
      }]
    },
    options: {
      scales: {
        y: { min, max }
      }
    }
  });
}

// Crear gr√°ficos
const gHumedad = crearGrafico("humedad", "Humedad (%)", 0, 100);
const gTempSuelo = crearGrafico("tempSuelo", "Temp. Suelo (¬∞C)", 10, 40);
const gTempAmb = crearGrafico("tempAmb", "Temp. Ambiente (¬∞C)", 10, 45);
const gLuz = crearGrafico("luz", "Luz", 0, 1200);
const gPh = crearGrafico("ph", "pH", 4, 8);

// Simulaci√≥n de sensores
function simular() {
  const humedad = Math.floor(Math.random() * 30) + 60;
  const tempSuelo = (Math.random() * 10 + 25).toFixed(1);
  const tempAmb = (Math.random() * 10 + 28).toFixed(1);
  const luz = Math.floor(Math.random() * 600) + 400;
  const ph = (Math.random() * 1.5 + 5.5).toFixed(1);

  actualizar(gHumedad, humedad);
  actualizar(gTempSuelo, tempSuelo);
  actualizar(gTempAmb, tempAmb);
  actualizar(gLuz, luz);
  actualizar(gPh, ph);

  generarRecomendacion(humedad, tempSuelo, ph);
}

function actualizar(grafico, valor) {
  const data = grafico.data;
  data.labels.push("");
  data.datasets[0].data.push(valor);

  if (data.labels.length > maxPuntos) {
    data.labels.shift();
    data.datasets[0].data.shift();
  }

  grafico.update();
}

// ü§ñ IA B√ÅSICA (REGLAS)
function generarRecomendacion(humedad, tempSuelo, ph) {
  let texto = "";

  if (humedad < 65) {
    texto += "‚ö†Ô∏è Humedad baja. Mantener suelo saturado para el replante. ";
  } else {
    texto += "‚úÖ Humedad adecuada para el arroz. ";
  }

  if (tempSuelo < 22) {
    texto += "‚ö†Ô∏è Temperatura del suelo baja. Retrasar replante. ";
  } else {
    texto += "üå± Temperatura del suelo favorable. ";
  }

  if (ph < 5.5 || ph > 7.0) {
    texto += "‚ö†Ô∏è pH fuera de rango ideal (5.5 ‚Äì 7.0).";
  } else {
    texto += "‚úÖ pH adecuado para el cultivo.";
  }

  document.getElementById("recomendacion").innerText = texto;
}

setInterval(simular, 3000);
</script>

</body>
</html>
